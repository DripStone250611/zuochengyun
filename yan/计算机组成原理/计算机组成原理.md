## 第 2 章 数据的表示和运算

### 2.3 浮点数的表示和运算

#### 2.3.1 浮点数的表示

**3. 浮点数的规格化**

尾数的位数决定浮点数的有效数位，有效数位越多，数据的精度越高。为了在浮点数运算的过程中尽可能多的保留有效数字的位数，使有效数字尽量占满尾数数位，必须在运算过程中对浮点数进行规格化操作。

**规格化操作：**是指通过调整一个非规格化浮点数的尾数和阶码的大小，使非零的浮点数在尾数的最高数位上保证是一个有效值。

 **左规：**当运算结果的尾数的最高数位不是有效位时，需要进行左规。左规时，尾数每左移一位、阶码减一（基数为2时），直至尾数变为规格化形式为止。左规可能会进行很多次。

**右规：**当运算结果的尾数的有效位进到小数点前面时，需要进行右规。将尾数右移一位、阶码加一，需要右规时，只需进行一次。

**4、IEEE 754 标准**

**32位单精度格式：**符号（1位）、阶码（8位）、尾数（23位），阶码偏置值127，尾数存在一个隐藏位，尾数实际有24位有效数字。

**64位双精度格式：**符号（1位）、阶码（11位）、尾数（52位），阶码偏置值为1023

阶码全零或全一有特别的解释（+0，-0，-∞，+∞）

**5、定点、浮点表示的区别**

（1）数值的表示范围

若定点数与浮点数的字长相同，则浮点表示法所能表示的数值范围远大于定点表示法。

（2）精度

对于字长相同的定点数和浮点数来说，浮点数扩大了数的表示范围，但是精度降低了

（3）数的运算

浮点数包括阶码和尾数两个部分，运算时不仅要做尾数的运算，还要做阶码的运算，运算结果要求规格化，比较复杂。

（4）溢出问题

在定点运算中，当运算结果超出书的表示范围时，发生溢出；浮点运算时，运算结果超出尾数表示范围却不一定溢出，只有规格化后阶码超过所能表示的范围时，才发生溢出。

#### 2.3.2 浮点数的加减运算

浮点数的加减运算分为以下几步：

**1、对阶**

对阶的目的是使两个操作数的小数点位置对齐，即使得两个数得阶码相等。为此，先求阶差，然后以小阶向大阶看起的原则，将阶码小的尾数右移一位，阶加一，直到两个数的阶码相等为止。尾数右移时，舍掉有效位会产生误差，影响精度。

**2、尾数求和**

将对阶后的尾数按定点数的加减运算规则运算。运算后的尾数不一定是规格化的，因此，浮点数的加减运算需要进一步进行规格化处理。

**3、规格化**

**4、舍入**

在对阶和尾数右规时，可能会对尾数进行右移，为保证运算精度，一般将低位移出的两位保留下来，参加中间过程的运算，最后将运算结果进行舍入。

常见的舍入方法有：0舍1入法、恒置1法、截断法。

**0舍1入法：**运算结果保留位的最高数位为0，则舍去；最高数位为1，则在尾数的末位加1.这样可能会使尾数溢出，此时需要再做一次右规。

**恒置1法：**只要因移位而丢失的位中有1，就把尾数末位置1，而不管原来是0还是1。

**截断法：**直接截取所需位数，丢弃后面所有的位。

**5、溢出判断**

若一个正指数超过了最大允许值（127或1023），则发生指数上溢，产生异常。若一个负指数超过了最小允许值（-149或-1074）则发生指数下溢，通常把结果当成0来处理。

1、右规和位数舍入时，需要检查是否溢出。

2、左规。

**6、C语言中的浮点数类型**

`char->int->long->double`和`float->double`强制类型转换没有精度损失。

- `int->float`  不会发生溢出，但是精度会受损失
- `double->float`  可能会发生溢出，可能精度会受到损失



#### 2.3.3 习题

**一、单选**

|  1   |  2   |  3   |  4   |  5   |
| :--: | :--: | :--: | :--: | :--: |
|  C   |  B   |  B   |  C   | B(C) |
|  6   |  7   |  8   |  9   |  10  |
|  B   |  C   | C(A) |  B   | A(D) |
|  11  |  12  |  13  |  14  |  15  |
|  D   |  D   |  D   | C(D) |  A   |
|  16  |  17  |  18  |  19  |  20  |
|  B   | A(D) |  D   |  D   |  C   |
|  21  |  22  |  23  |  24  |  25  |
| D(C) |  D   |  B   |  A   |  D   |
|  26  |  27  |  28  |  29  |  30  |
|  A   |  A   |  D   | B(A) |  A   |
|  31  |  32  |      |      |      |
|  A   |  A   |      |      |      |



## 第 3 章 存储系统

### 3.1 存储器概述

#### 3.1.1 存储器的分类

**1、按在计算机中的作用（层次）分类**

1）主存储器。简称主存，又称内存储器（内存）。可以直接被CPU访问。可以和高速缓冲存储器（Cache）及辅助存储器交换顺序。容量小，存取速度较快。

2）辅助存储器。简称辅存，又称外存储器（外存）。用来存放当前暂时用不到的程序和数据。需要调入主存后才可以被CPU访问。

3）高速缓冲存储器。简称Cache，位于主存和CPU之间，用来存放当前CPU经常使用的指令和数据，以便CPU可以高速的访问它们。Cache的存取速度可与CPU的速度相匹配，现代计算机通常将它们制作在CPU中。

**2、按存储介质分类**

按存储介质，存储器可以分为此表面存储器（磁带、磁盘）、磁芯存储器、半导体存储器和光存储器。

**3、按存取方式分类**

1）随机存储器（RAM）。存储器的任何一个存储单元都可以随机存取。

2）只读存储器（ROM）。存储器的内容只能随机读出而不能写入。

3）串行访问存储器。

**4、按信息的可保存性分类**

断电后，存储信息及消失的存储器，称为易失性存储器。断电后信息仍然保持的存储器称为非易失性存储器。

#### 3.1.2 存储器的性能指标

存储器有三个性能指标，即存储容量、单位成本和存储速度。

1）存储容量 = 存储字数✖️字长。

2）单位成本：每位价格 = 总成本 / 总容量。

3）存储速度：数据传输率 = 数据的宽度/存取周期。

- 存取时间（T~a~):存取时间是指从启动一次存储器操作到完成该操作所经历的时间，分为读出时间和写入时间。
- 存取周期（T~m~):存取周期又称读写周期或访问周期。它是指存储器进行一次完整的读写操作所需的全部时间，即连续两次独立访问存储器操作之间所需的最小时间间隔。
- 主存带宽（B~m~):主存带宽又称数据传输率，表示每秒从主存进出信息的最大数量。
- 存取周期 = 存取时间 + 恢复时间

#### 3.1.3 多级层次的存储系统

![](/img/3-1.png)



#### 3.1.4 习题

**一、单选**

|  1   |  2   |  3   |  4   |  5   |
| :--: | :--: | :--: | :--: | :--: |
| C(D) |  C   |  B   |  D   |  A   |
|  6   |  7   |  8   |  9   |  10  |
|  C   |  B   |  B   |  D   |  D   |
|  11  |  12  |  13  |  14  |  15  |
|  D   |  D   |  A   |  B   |      |

### 3.2 主存储器

#### 3.2.1 SRAM芯片和DRAM芯片

**1、SRAM的工作原理**

通常把存放一个二进制位的物理器件称为存储元，它是存储器的最基本的构件。地址码相同的多个存储元构成一个存储单元。若干个存储单元的集合构成存储体。

静态随机存储器（SRAM）的存储元是用双稳态触发器（六晶体管MOS）来记忆的，因此即使信息读出后，他仍保持其原状态而不需要再生（非破坏性读出）。

SRAM的存取速度快，但集成度低，功耗较大，价格昂贵，一般用于高速缓冲存储器。

**2、DRAM的工作原理**

动态随机存储器（DRAM）是利用存储元电路中栅极电容上的电荷来存储信息的，DRAM的基本存储元通常只是用一个晶体管，所以它比SRAM的密度要高很多。一般用于主存系统。

DRAM电容上的电荷一般只能维持1~2ms，因此即使电源不断电，信息也会自动消失。为此，每隔一定时间必须刷新，通常取2ms，成为刷新周期。常用的刷新方式有3种：

1. 集中刷新：在一个刷新周期内，利用一段固定的时间，依次对存储器的所有行进行逐一再生，在此期间停止对存储器的读写操作，成为“死时间”，又称访存“死区”。优点：读写操作时不受刷新工作的影响；缺点：再集中刷新期间不能访问存储器。
2. 分散刷新：把对每一行的刷新分散到各个工作周期中。优点：没有死区；缺点：加长了系统的存取周期，降低了整机的速度。
3. 异步刷新：结合上两种做法。将刷新周期除以行数，得到两次刷新操作之间的时间间隔t，利用逻辑电路每隔时间t产生一次刷新请求。

DRAM的刷新需注意以下问题：1、刷新对CPU是透明的，即刷新不依赖于外部访问；2、动态RAM的刷新单位是行，由芯片内部自行生成行地址；3、刷新操作类似于读操作，但又有所不同。

**3、DRAM芯片的读写周期**

![](img/3-2.png)

**4、SRAM和DRAM的比较**

|            |   SRAM   |   DRAM   |
| :--------: | :------: | :------: |
|   存储元   |  触发器  |   电容   |
| 破坏性读出 |    非    |    是    |
|  需要刷新  |   不要   |   需要   |
| 送行列地址 |  同时送  | 分两次送 |
|  运行速度  |    快    |    慢    |
|   集成度   |    低    |    高    |
|  存储成本  |    高    |    低    |
|  主要用途  | 高速缓存 | 主机内存 |

**5、存储器芯片的内部结构**

#### 3.2.2 只读存储器

**1.只读存储器（ROM）的特点**

- 结构简单，所以位密度比可读写存储器高。
- 具有非易失性，可靠性高。

**2. ROM的类型**

根据制造工艺的不同，ROM可分为掩模式只读存储器（MROM）、一次可编程只读存储器（PROM）、可擦除可编程只读存储器（EPROM）、Flash存储器和固态硬盘（SSD）。

（1）掩模式只读存储器

MROM的内容由半导体制造厂按用户提出的要求在芯片生产过程中直接写入，写入以后任何人都无法改变其内容。

（2）一次可编程只读存储器

PROM是可以实现一次性编程的只读存储器。允许用户利用专门的设备（编程器）写入自己的程序，一旦写入，内容就无法改变。

（3）可擦除可编程只读存储器

EPROM不仅可以由用户利用编程器写入信息，而且可以对其内容进行多次改写。但它不能取代RAM，因为EPROM的编程次数有限，且写入时间过长。

（4）Flash存储器

Flash存储器可以在不加电的情况下长期保存信息。

（5）固态硬盘

由控制单元和存储单元（Flash芯片）组成。

#### 3.2.3 主存储器的基本组成

#### 3.2.4 多模块存储器



